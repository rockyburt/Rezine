{% extends "admin/layout.html" %}
{% block title %}{% trans "Configure Widgets" %}{% endblock %}
{% block contents %}
  <h2>{% trans "Configure Widgets" %}</h2>
  {% if not manageable %}
    <p>{% trans %}
      The overlay "_widgets.html" which is used by the widget manager
      was altered by hand in a way that the widget manager cannot extract
      the widget calls. If you want to continue maintaining it from the
      overlay editor that's perfectly fine. If you however want to use
      this widget editor again you have to remove the overlay for the
      template "_widgets.html".
    {% endtrans %}</p>
  {% else %}
    <script type="text/javascript">
      var $all_widgets = {{ all_widgets|jsonencode }};
      var $active_widgets = {{ active_widgets|jsonencode }};

      $(function() {
        for (var id in $all_widgets) {
          var name = $all_widgets[id][0];
          var options = $all_widgets[id][1];
          $('<li class="widget"></li>')
            .attr('id', id)
            .text(name)
            .draggable({helper: 'clone'})
            .appendTo('#inventory');
        };
        $('#sidebar').droppable({
          accept:       '.widget',
          tolerance:    'touch',
          hoverClass:   '.droppable-active',
          drop: function(ev, ui) {
            $('#sidebar').append($(ui.element).clone());
          }
        });
      });
    </script>
    <form action="" method="post">
      <input type="hidden" name="widgets" value="">
      <ul id="sidebar"></ul>
      <div class="inventory">
        <h3>{% trans "Available Widgets" %}</h3>
        <ul id="inventory"></ul>
        <br style="clear: both">
      </div>
      <div class="actions">
        <input type="submit" value="{% trans 'Save' %}">
      </div>
    </form>
  {% endif %}
{% endblock %}
