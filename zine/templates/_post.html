{% macro render_post(post) -%}
  <div class="post">
    {{ emit_event('before-post-rendered', post) }}
    <h3><a href="{{ url_for(post)|e }}">{{ post.title|e }}</a></h3>
    <p class="meta">
      {%- trans author='<a href="%s">%s</a>' %
        (url_for(post.author), post.author.display_name|e),
        pub_date=post.pub_date|datetimeformat|e -%}
          written by {{ author }}, on {{ pub_date }}.
      {%- endtrans %}
      {%- if post.is_sheduled %}<br>[ {% trans
        time_span=post.pub_date|timedeltaformat
        %}<strong>Sheduled Post:</strong> This post will appear in {{
          time_span }}.{% endtrans %}
      {% endif -%}]
    </p>
    <div class="text">
      {{ post.intro or post.body }}
      {% if post.intro -%}
        <p><a href="{{ url_for(post)|e }}#extended">{{ _("Read on") }}...</a></p>
      {%- endif %}
    </div>
    <p class="related">
      {{ _('Categories') }}:
      {% for category in post.categories -%}
        <a href="{{ url_for(category)|e }}">{{ category.name|e }}</a>
        {%- if not loop.last %}, {% endif %}
      {%- else -%}
        {{ _("nothing") }}
      {%- endfor %} |
      <a href="{{ url_for(post)|e }}#comments">{% trans comments=post.comment_count
         %}{{ comments }} comment{% pluralize %}{{ comments}} comments{% endtrans -%}</a>
      {%- if request.user.is_manager %}
      | <a href="{{ url_for('admin/edit_post', post_id=post.post_id) }}">{{ _('Edit') }}</a>
      {%- endif %}
    </p>
    {{ emit_event('after-post-rendered', post) }}
  </div>
{%- endmacro %}
